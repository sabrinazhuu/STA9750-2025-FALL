---
title: "Beyond Bike Lanes: What Drives E-Bike Usage in Manhattan"
subtitle: "STA 9750 Individual Final Report"
author: "Sabrina Zhu"
date: today
editor:
    mode: source
format:
    html:
        code-fold: true
---

\

::: {.callout-note icon="false" style="padding: 16px 20px;"}
## Project Overview

\
**Group:** The Cycle Paths
**Data Period:** October 2024 – October 2025

**Data Source:** [Citi Bike System Data](https://citibikenyc.com/system-data) | [NYC Open Data](https://catalog.data.gov/dataset/new-york-city-bike-routes)

**Project Structure:**

1.  Introduction & Research Question
2.  Data Acquisition
3.  Methodology
4.  Results (E-bike Usage Analysis)
5.  Multi-Dimensional Analysis
6.  Discussion & Conclusion
:::

\

# Introduction

Citi Bike plays a central role in New York City’s transportation system, supporting millions of trips each year for commuting, errands, and short-distance travel. As the system has expanded across Manhattan, changes in bike availability, rider behavior, and supporting infrastructure have reshaped how people use bike-share in the city.

One of the most visible shifts within the Citi Bike system is the growing presence of electric bikes (e-bikes), which offer a faster and less physically demanding alternative to classic bikes. In Manhattan, e-bikes now account for approximately {{< contents overall_ebike_pc >}}% of all Citi Bike trips, signaling a meaningful change in how riders move through the city.

This analysis is part of a group project investigating the overarching question:

> Among weather, time, location, and other rider characteristics, which variables are the most important drivers of Citi Bike trip volume in Manhattan?

While my teammates examine ridership patterns related to routes, weather conditions, time of day, day of week, and rider type, my contribution focuses on whether infrastructure affects not just how much people ride, but what they choose to ride.

This analysis examines whether infrastructure plays a meaningful role in shaping bike type choice within the Citi Bike system. If infrastructure is strongly associated with e-bike usage, it suggests that physical design and station placement may influence how riders interact with the network. If the relationship is weaker or inconsistent, bike type patterns may instead reflect rider behavior, pricing structures, or operational factors such as bike availability and rebalancing. Examining this relationship helps situate infrastructure alongside other drivers of Citi Bike usage considered in the group analysis.

\

## Specific Research Question

To explore our overarching research question, the group identified several specific questions, and my contribution focuses on:

> How does station infrastructure relate to e-bike vs classic bike usage?

This question focuses on understanding how characteristics of stations, such as proximity to bike lanes and station density, may influence riders’ choice between e-bikes and classic bikes. By examining this relationship, we can see how infrastructure fits into the broader set of factors driving Citi Bike trip volume in Manhattan.

\

# Data Acquisition

## Citi Bike Trip Data

```{r setup}
#| message: false

library(data.table)
library(sf)
library(ggplot2)
library(dplyr)
library(knitr)

# Create directories
dir.create("data/processed", showWarnings = FALSE, recursive = TRUE)
dir.create("data/gis", showWarnings = FALSE, recursive = TRUE)
dir.create("data/individual_report", showWarnings = FALSE, recursive = TRUE)

# Create manhattan polygon if it doesn't exist
if (!file.exists("data/gis/manhattan_polygon.rds")) {
  borough_url <- "https://www.nyc.gov/assets/planning/download/zip/data-maps/open-data/nybb_16a.zip"
  borough_zip <- "data/gis/nyc_boroughs.zip"
  
  download.file(borough_url, borough_zip, mode = "wb")
  unzip(borough_zip, exdir = "data/gis")
  
  shp_file <- list.files("data/gis", pattern = "\\.shp$", recursive = TRUE, full.names = TRUE)[1]
  
  boroughs <- st_read(shp_file, quiet = TRUE)
  boroughs <- st_transform(boroughs, 4326)
  manhattan_poly <- boroughs[boroughs$BoroName == "Manhattan", ]
  
  saveRDS(manhattan_poly, "data/gis/manhattan_polygon.rds")
}
```

The primary dataset for this analysis comes from [Citi Bike](https://citibikenyc.com/system-data)'s publicly available system data. I downloaded monthly trip data from October 2024 through October 2025, covering a full year of ridership patterns. To focus on Manhattan, I filtered trips to only include those starting within Manhattan's borough boundaries using a spatial join with NYC borough shapefiles.

\

### Full Dataset Overview

```{r load-full-data}
citibike_manhattan_all <- readRDS("data/processed/citibike_manhattan_all_202410_202510.rds")
manhattan_poly <- readRDS("data/gis/manhattan_polygon.rds")


full_dataset <- format(nrow(citibike_manhattan_all), big.mark = ",")
```

The full dataset contains **`r format(nrow(citibike_manhattan_all), big.mark = ",")`** Manhattan trips, spanning from `r format(min(citibike_manhattan_all$date), "%B %d, %Y")` to `r format(max(citibike_manhattan_all$date), "%B %d, %Y")`

```{r full-data-summary}
overall_summary <- citibike_manhattan_all[, .(
  Total = .N,
  Electric = sum(rideable_type == "electric_bike"),
  Classic = sum(rideable_type == "classic_bike")
), by = member_casual][
  , `:=`(
    Pct_Electric = round(Electric / Total * 100, 1),
    Pct_Classic = round(Classic / Total * 100, 1)
  )
]

overall_summary[, member_casual := factor(member_casual, levels = c("casual", "member"))]
setorder(overall_summary, member_casual)

# Calculate key stats for inline reporting
overall_ebike_pct <- round(sum(overall_summary$Electric) / sum(overall_summary$Total) * 100)
casual_ebike_pct <- overall_summary[member_casual == "casual", Pct_Electric]
member_ebike_pct <- overall_summary[member_casual == "member", Pct_Electric]
member_trip_pct <- round(overall_summary[member_casual == "member", Total] / sum(overall_summary$Total) * 100)

display_table <- overall_summary[, .(
  `Rider Type` = tools::toTitleCase(as.character(member_casual)),
  `Total Trips` = format(Total, big.mark = ","),
  `Electric Bikes` = format(Electric, big.mark = ","),
  `% Electric` = Pct_Electric,
  `Classic Bikes` = format(Classic, big.mark = ","),
  `% Classic` = Pct_Classic
)]

kable(display_table, align = c("l","r","r","r","r","r"))
```

[`{r} overall_ebike_pct`]{#overall_ebike_pc}

Key observations:

-   **Overall e-bike preference**: `r overall_ebike_pct`% of all trips use e-bikes
-   **Casual riders prefer e-bikes more**: `r casual_ebike_pct`% vs `r member_ebike_pct`% for members
-   **Members dominate volume**: `r member_trip_pct`% of all trips are by members

\

### Stratified Sampling

```{r load-sample}
citibike_sample <- readRDS("data/processed/citibike_manhattan_sample_5pct.rds")
```

Given the size of the full dataset (over 32 million trips), performing spatial analysis on every record would be computationally expensive. To make the analysis more manageable while preserving the representativeness of the data, I created a 5% stratified sample.

The sampling was stratified by date, meaning **5% of trips were randomly selected from each day.** This approach ensures that: 

- All days in the study period are represented proportionally 
- Seasonal patterns and day-to-day variation are preserved 
- The sample maintains the same temporal distribution as the full dataset

\

## NYC Bike Routes Data

```{r load-routes}
routes <- readRDS("data/individual_report/bike_routes.rds")

manhattan_bbox <- st_bbox(c(xmin = -74.02, xmax = -73.90, ymin = 40.70, ymax = 40.88), 
                          crs = st_crs(4326)) |> st_as_sfc()

manhattan_routes <- routes %>%
  filter(st_intersects(geometry, manhattan_bbox, sparse = FALSE)[,1]) %>%
  st_transform(4326)
```

To assess infrastructure quality, I also obtained bike route data from [NYC Open Data](https://catalog.data.gov/dataset/new-york-city-bike-routes), which contains information on all designated bike routes in New York City.

```{r routes-summary}
routes_summary <- data.frame(
    Metric = c("Total route segments in NYC", 
                "Route segments in Manhattan",
                "Unique streets with bike routes"),
    Value = c(format(nrow(routes), big.mark = ","),
               format(nrow(manhattan_routes), big.mark = ","),
               length(unique(manhattan_routes$street)))
)
 
knitr::kable(routes_summary, col.names = c("Metric", "Value"))
```

After filtering to Manhattan, the dataset contains **`r format(nrow(manhattan_routes), big.mark = ",")`** bike route segments across **`r length(unique(manhattan_routes$street))`** streets.

\

# Methodology

## Rider Type Distribution in Sample

Before examining infrastructure effects, it is important to verify that our sample maintains the same patterns as the full dataset.

```{r sample-rider-summary}
rider_summary <- citibike_sample[, .(
  total_trips = .N,
  electric_bikes = sum(rideable_type == "electric_bike"),
  classic_bikes = sum(rideable_type == "classic_bike")
), by = member_casual]

rider_summary[, `:=`(
  pct_electric = round(electric_bikes / total_trips * 100, 1),
  pct_classic = round(classic_bikes / total_trips * 100, 1)
)]

rider_summary[, member_casual := tools::toTitleCase(member_casual)]

knitr::kable(rider_summary, 
             col.names = c("Rider Type", "Total Trips", "Electric Bikes", 
                          "Classic Bikes", "% Electric", "% Classic"),
             format.args = list(big.mark = ","))
```

The sample confirms the same patterns seen in the full dataset, validating our sampling approach.

\

## Infrastructure Classification

```{r infrastructure-calc}
# Get unique stations with coordinates
stations <- citibike_sample[!is.na(start_station_id) & 
                             !is.na(start_lat) & 
                             !is.na(start_lng), 
                           .(lat = first(start_lat),
                             lng = first(start_lng),
                             station_name = first(start_station_name)),
                           by = start_station_id]

# Convert to spatial object
stations_sf <- st_as_sf(stations, coords = c("lng", "lat"), crs = 4326, remove = FALSE)

# Metric 1: Station Density (count nearby stations within 500m)
stations_buffer <- st_buffer(stations_sf, dist = 500)
stations$nearby_count <- sapply(1:nrow(stations_sf), function(i) {
  sum(st_intersects(stations_buffer[i, ], stations_sf, sparse = FALSE)) - 1
})

# Metric 2: Distance to Bike Lanes
stations$dist_to_bike_lane_m <- sapply(1:nrow(stations_sf), function(i) {
  distances <- st_distance(stations_sf[i, ], manhattan_routes)
  min(as.numeric(distances))
})

# Create Infrastructure Score (normalized 0-1)
stations$density_score <- (stations$nearby_count - min(stations$nearby_count)) / 
  (max(stations$nearby_count) - min(stations$nearby_count))

max_dist <- quantile(stations$dist_to_bike_lane_m, 0.95)
stations$lane_proximity_score <- 1 - pmin(stations$dist_to_bike_lane_m, max_dist) / max_dist

stations$infrastructure_score <- 0.5 * stations$density_score + 0.5 * stations$lane_proximity_score

# Classify into tertiles
tertiles <- quantile(stations$infrastructure_score, probs = c(0.33, 0.67))
stations$infrastructure_level <- cut(
  stations$infrastructure_score,
  breaks = c(-Inf, tertiles[1], tertiles[2], Inf),
  labels = c("Low", "Medium", "High"),
  include.lowest = TRUE
)

# Store counts for inline reporting
n_stations <- nrow(stations)
infra_counts <- table(stations$infrastructure_level)
```

To examine the relationship between infrastructure and bike type usage, I developed a composite infrastructure score for each Citi Bike station. This score combines two metrics that capture different aspects of cycling infrastructure quality.

1.  **Station density:** The number of other Citi Bike stations within a 500-meter radius. Higher density reflects better network coverage, giving riders more options for starting and ending trips.

2.  **Bike lane proximity:** The distance from each station to the nearest bike lane. Stations closer to bike lanes provide riders with immediate access to dedicated cycling infrastructure.

The analysis identified **`r n_stations`** unique stations. After classification, stations were distributed as follows: `r infra_counts["Low"]` Low, `r infra_counts["Medium"]` Medium, and `r infra_counts["High"]` High infrastructure.

\

## Infrastructure Map

The map below shows how stations are classified across Manhattan. High-infrastructure stations (green) concentrate in Lower Manhattan and Midtown, while low-infrastructure stations (red) appear primarily in Upper Manhattan.

```{r map-infrastructure}
#| fig-cap: "Station Infrastructure Classification Across Manhattan"
#| fig-width: 10
#| fig-height: 12

ggplot() +
  geom_sf(data = manhattan_poly, fill = "gray95", color = "gray60", size = 0.3) +
  geom_sf(data = manhattan_routes, color = "lightblue", alpha = 0.3, size = 0.5) +
  geom_point(data = stations, 
             aes(x = lng, y = lat, color = infrastructure_level, size = nearby_count),
             alpha = 0.7) +
  scale_color_manual(
    values = c("Low" = "#F44336", "Medium" = "#FF9800", "High" = "#4CAF50"),
    name = "Infrastructure Level"
  ) +
  scale_size_continuous(name = "Station Density", range = c(1, 4)) +
  labs(
    title = "Citi Bike Station Infrastructure",
    subtitle = "Stations classified by bike lane proximity and station density",
    caption = "Size indicates number of nearby stations within 500m"
  ) +
  theme_minimal() +
  theme(
    panel.grid = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    legend.position = "right",
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 10, color = "gray40")
  )
```

This geographic pattern reflects Manhattan's urban development and transportation priorities. Lower Manhattan and Midtown are the borough's primary commercial and business districts, home to major employment centers, transit hubs, and tourist destinations. These areas have seen greater investment in cycling infrastructure to serve the high volume of commuters and visitors. The dense street grid also allows for more bike lane installations and supports a tighter network of Citi Bike stations.

In contrast, Upper Manhattan is more residential with lower population density, fewer commercial destinations, and less demand for cycling infrastructure. The street network is also less uniform, with more hills and parks that limit where bike lanes and stations can be placed.

\

# Results

## E-bike Usage by Infrastructure Level

```{r station-ebike-calc}
# Calculate e-bike % by station
station_variation <- citibike_sample[, .(
  ebike_pct = mean(rideable_type == "electric_bike") * 100,
  trips = .N,
  lat = mean(start_lat),
  lng = mean(start_lng)
), by = start_station_name]

# Merge with infrastructure
station_full <- merge(station_variation, 
                      stations[, .(station_name, infrastructure_level, infrastructure_score)],
                      by.x = "start_station_name", 
                      by.y = "station_name",
                      all.x = TRUE)

# Calculate bike balance (relative to average)
overall_ebike_share <- mean(citibike_sample$rideable_type == "electric_bike") * 100
station_full[, bike_balance := ebike_pct - overall_ebike_share]

# Calculate average e-bike usage by infrastructure level
low_med_ebike <- mean(station_full[infrastructure_level %in% c("Low", "Medium"), ebike_pct], na.rm = TRUE)
high_ebike <- mean(station_full[infrastructure_level == "High", ebike_pct], na.rm = TRUE)
ebike_diff <- low_med_ebike - high_ebike
```

Low and medium infrastructure stations average approximately `r round(low_med_ebike)`% e-bike usage, while high-infrastructure stations average only `r round(high_ebike)`%, a difference of about `r round(ebike_diff)` percentage points.

These averages are above and below the Manhattan-wide e-bike share (about `r overall_ebike_pct`%), respectively, indicating a modest negative association between infrastructure level and e-bike usage.

```{r}
#| label: infra-ebike-summary

# Summary by infrastructure level
infra_summary <- station_full[!is.na(infrastructure_level), .(
  mean_ebike = round(mean(ebike_pct), 1),
  sd_ebike = round(sd(ebike_pct), 1),
  total_trips = sum(trips),
  n_stations = .N
), by = infrastructure_level]

knitr::kable(infra_summary,
             col.names = c("Infrastructure Level", "Mean E-bike %", "SD", "Total Trips", "Stations"))
```

\

## Station-Level Analysis

```{r scatter-plot}
#| message: false
#| fig-cap: "Infrastructure Score vs E-bike Usage by Station"
#| fig-width: 10
#| fig-height: 7

ggplot(station_full[!is.na(infrastructure_score) & trips >= 50 & ebike_pct >= 40], 
       aes(x = infrastructure_score, y = ebike_pct)) +
  geom_point(aes(color = infrastructure_level, size = trips), alpha = 0.6) +
  geom_smooth(method = "lm", color = "black", linetype = "dashed", se = TRUE) +
  scale_color_manual(values = c("Low" = "#F44336", "Medium" = "#FF9800", "High" = "#4CAF50"),
                     name = "Infrastructure Level") +
  scale_size_continuous(range = c(1, 6), name = "Total Trips") +
  labs(
    title = "Infrastructure Score vs. E-bike Usage",
    subtitle = "Each dot is a station | Dashed line shows overall trend",
    x = "Infrastructure Score (higher = better infrastructure)",
    y = "E-bike Usage (%)"
  ) +
  theme_minimal() +
  theme(plot.title = element_text(size = 14, face = "bold"))
```

```{r correlation}
cor_value <- cor(station_full$infrastructure_score, station_full$ebike_pct, use = "complete.obs")
```

At the station level, e-bike share is weakly negatively correlated with infrastructure score (r = `r round(cor_value, 2)`, where r measures the strength of the relationship from -1 to 1). The negative value confirms that higher infrastructure is associated with lower e-bike usage, though the relationship is weak.

\

## Geographic Pattern

The map below shows each station's e-bike usage relative to the Manhattan average of `r round(overall_ebike_share)`%. Orange indicates above-average e-bike usage; blue indicates above-average classic bike usage.

```{r balance-map}
#| fig-cap: "E-bike Usage Relative to Manhattan Average"
#| fig-width: 10
#| fig-height: 12

ggplot() +
  geom_sf(data = manhattan_poly, fill = "gray95", color = "gray60", linewidth = 0.3) +
  geom_point(data = station_full[trips >= 50],
             aes(x = lng, y = lat, color = bike_balance, size = trips),
             alpha = 0.9) +
  scale_color_gradientn(
    colors = c("#08306b", "#2171b5", "#6baed6", "#f7f7f7", "#fcbba1", "#fb6a4a", "#cb181d"),
    values = scales::rescale(c(-60, -30, -10, 0, 10, 25, 40)),
    limits = c(-60, 40),
    breaks = c(-30, 0, 20),
    labels = c("More classic", "Near avg", "More e-bikes"),
    name = "Relative E-bike Share"
  ) +
  scale_size_continuous(range = c(2, 7), name = "Station\nTrip Volume", labels = scales::comma) +
  labs(
    title = "Where Are Stations More or Less E-bike-Heavy?",
    subtitle = "Orange = higher e-bike usage | Blue = lower e-bike usage",
    caption = "Data: Citi Bike Manhattan trips | Stations with 50+ trips shown"
  ) +
  coord_sf(datum = NA) +
  theme_minimal() +
  theme(
    panel.grid = element_blank(),
    axis.text = element_blank(),
    axis.title = element_blank(),
    legend.position = "right",
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 10, color = "gray40")
  )
```

Lower Manhattan and Midtown appear predominantly blue, indicating below-average e-bike usage, while Upper Manhattan appears predominantly orange, showing above-average e-bike usage. This pattern runs opposite to what the infrastructure map would suggest, as areas with the densest stations and the most protected bike lanes have the lowest e-bike usage rates.

One possible explanation is that high-infrastructure areas are also high-demand areas. Lower Manhattan and Midtown attract more riders due to their concentration of offices, transit hubs, and tourist destinations. With more riders competing for bikes at these stations, e-bikes may get taken first, leaving later riders with only classic bikes available. In contrast, Upper Manhattan has fewer stations and less dense infrastructure, which may encourage riders to choose e-bikes for longer trips or routes with more challenging terrain. Other factors, such as demographic differences and commuting patterns, may also contribute to this distribution.


```{r volume-ebike}
# Show that high-volume stations have lower e-bike usage
station_full[, volume_tercile := cut(trips, 
                                      breaks = quantile(trips, probs = c(0, 0.33, 0.67, 1), na.rm = TRUE),
                                      labels = c("Low Volume", "Medium Volume", "High Volume"),
                                      include.lowest = TRUE)]

volume_ebike <- station_full[!is.na(volume_tercile), .(
  mean_ebike = round(mean(ebike_pct), 1),
  n_stations = .N
), by = volume_tercile]

setorder(volume_ebike, -mean_ebike)

knitr::kable(volume_ebike, col.names = c("Station Volume", "Average E-bike %", "Stations"))
```

The data supports this interpretation: high-volume stations show lower e-bike usage than low-volume stations. This is consistent with e-bikes being depleted faster at busy locations.

However, this analysis cannot definitively prove that availability is the cause. That would require real-time bike inventory data. What the data does show is that demand and e-bike usage are inversely related, which explains why high-infrastructure areas also show lower e-bike usage rates.

\

## Multi-Dimensional Analysis
```{r heatmap-data}
# Define time periods
citibike_sample[, time_period := fcase(
  hour %in% c(6,7,8,9), "Morning Rush",
  hour %in% c(10,11,12,13,14,15), "Midday",
  hour %in% c(16,17,18,19), "Evening Rush",
  hour %in% c(20,21,22,23,0,1,2,3,4,5), "Night"
)]
citibike_sample[, time_period := factor(time_period, 
  levels = c("Morning Rush", "Midday", "Evening Rush", "Night"))]

# Define volume groups
citibike_sample[, station_volume := .N, by = start_station_name]
citibike_sample[, volume_group := cut(station_volume, 
  breaks = quantile(station_volume, probs = c(0, 0.33, 0.67, 1)),
  labels = c("Low Traffic", "Medium Traffic", "High Traffic"),
  include.lowest = TRUE)]

# Calculate e-bike % by rider type, volume, and time
ebike_full <- citibike_sample[!is.na(volume_group) & !is.na(time_period), .(
  ebike_pct = mean(rideable_type == "electric_bike") * 100,
  trips = .N
), by = .(member_casual, volume_group, time_period)]

ebike_full[, rider_label := ifelse(member_casual == "casual", "Casual Riders", "Members")]
```

To further examine whether the pattern holds across different conditions, I analyzed e-bike usage across three dimensions: rider type, station traffic level, and time of day.


### E-bike Usage Heatmap

```{r heatmap}
#| message: false
#| warning: false
#| fig-cap: "E-bike Usage Patterns Across Multiple Dimensions"
#| fig-width: 12
#| fig-height: 6

ggplot(ebike_full, aes(x = time_period, y = volume_group, fill = ebike_pct)) +
  geom_tile(color = "white", linewidth = 1.5) +
  geom_text(aes(label = paste0(round(ebike_pct, 1), "%")),
            size = 4.5, fontface = "bold", color = "white") +
  facet_wrap(~rider_label) +
  scale_fill_gradient2(
    low = "#3498db",
    mid = "#95a5a6",
    high = "#e74c3c",
    midpoint = 68,
    name = "E-bike\nUsage",
    limits = c(60, 80),
    breaks = seq(60, 80, 5),
    labels = function(x) paste0(x, "%")
  ) +
  labs(
    title = "E-bike Usage Patterns Across Multiple Dimensions",
    subtitle = "Blue = More classic bikes | Red = More e-bikes | Overall average = 68% e-bikes",
    x = "Time of Day",
    y = "Station Activity Level",
    caption = "Rider Type Distribution: Casual - 22% | Member - 78%"
  ) +
  theme_minimal(base_size = 13) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 11),
    axis.text.y = element_text(size = 11),
    strip.text = element_text(size = 14, face = "bold"),
    plot.title = element_text(size = 16, face = "bold", hjust = 0),
    plot.subtitle = element_text(size = 11, color = "gray30"),
    plot.caption = element_text(hjust = 0, size = 9),
    panel.grid = element_blank(),
    legend.position = "right"
  )
```

```{r}
#| label: heatmap-extremes

# Get extreme values for inline reporting
max_ebike <- ebike_full[which.max(ebike_pct)]
min_ebike <- ebike_full[which.min(ebike_pct)]
```

The heatmap highlights how rider type, station traffic, and time of day interact to influence e-bike usage. Overall, e-bike use is higher among casual riders, who may prioritize convenience over cost since the additional fee has little impact on occasional trips. Members ride more regularly, making e-bikes more expensive over time, which likely contributes to their lower usage.

The lowest e-bike usage occurs at high-traffic stations during the morning rush, and the highest occurs at low-traffic stations during the evening rush. This pattern suggests that availability could play a role. At busy stations in the morning, e-bikes may be taken quickly, so some riders are left with only classic bikes. Even though many e-bikes are being used, the observed proportion of trips that are e-bikes is lower because not all riders can access them. In contrast, low-traffic stations or evening periods have fewer riders at the same time, so e-bikes are more likely to be available for anyone who wants one, resulting in a higher percentage of e-bike trips.

\

# Discussion

## Interpreting the Findings

The central finding of this analysis is counterintuitive: stations with better cycling infrastructure show lower e-bike usage rates. The most plausible explanation is that infrastructure quality correlates with demand, and high demand leads to e-bike depletion. 

The data shows consistent patterns across multiple dimensions. High-volume stations show 67.1% e-bike usage compared to 74.4% at low-volume stations, a difference that cannot be explained by infrastructure quality alone. Similarly, morning-evening variations suggest time-varying availability rather than systematic preference changes. 

However, without real-time inventory data, the availability explanation remains an inference rather than a confirmed fact. 

## Implications for Group Analysis

This finding has direct implications for predictive modeling: the weak correlation between infrastructure and e-bike usage (r ≈ -0.165), combined with the inverse relationship with station volume, suggests e-bike share is driven by the same factors as overall ridership. Including it as a separate predictor may introduce 
multicollinearity and measurement error, which could explain why the group's model performance improved when e-bike share was removed.

## Limitations

Several limitations should be acknowledged: 

1. **No direct availability data**:  Without real-time bike inventories, we cannot 
   distinguish rider preferences from constrained choices. Any observed e-bike 
   percentage may reflect supply rather than demand.

2. **Limited infrastructure metrics**: Only station density and bike lane proximity 
   were included. Traffic volume, topography, and bike lane quality were not captured.

3. **Manhattan-specific context**: These findings may not generalize to other boroughs 
   or urban areas. 

4. **Unmeasured confounders**: Infrastructure correlates with employment density, 
   tourist destinations, and transit connectivity, making it difficult to isolate 
   its independent effect.

## Recommendations

Given these limitations, the following recommendations should be considered preliminary: 

**For Citi Bike operators:**
- Investigate availability using real-time inventory data before implementing changes
- Consider dynamic rebalancing if e-bike depletion is confirmed
- Test rider incentives to improve e-bike distribution

**For urban planners:**
- Coordinate infrastructure expansion with operational capacity
- Recognize that bike lanes attract demand that must be met with adequate supply

\

# Conclusion

This analysis examined whether station infrastructure (measured by station density and bike lane proximity) directly influences bike type choice in Manhattan's Citi Bike system. The findings suggest it does not.  Instead, e-bike usage patterns appear to reflect the same demand and operational factors that drive overall ridership. 

**Key findings from this analysis:**

- High-infrastructure stations in Lower Manhattan and Midtown show *lower* e-bike 
  usage (67%) compared to low-infrastructure stations in Upper Manhattan (72%)
- The correlation between infrastructure and e-bike usage is weakly negative 
  (r = `r round(cor_value, 2)`)
- E-bike usage is highest at low-traffic stations during evening rush, and lowest 
  at high-traffic stations during morning rush

These patterns support the group's overall findings: 

- **E-bikes account for approximately 68% of all trips**, reflecting strong rider 
  preference for the easier riding experience
- **Casual riders rely more heavily on e-bikes** (73% vs 67% for members), 
  consistent with prioritizing comfort over cost
- **E-bike usage peaks during evening hours**, suggesting riders prefer easier trips 
  home after a long day
- **Members remain more cost-sensitive**, showing lower e-bike usage across all 
  conditions

The most likely explanation for the infrastructure paradox is availability. High-infrastructure areas attract more riders, which depletes e-bikes faster.  This is consistent with the group's limitation that e-bike availability varies by station and time in ways that are not directly modeled. 

**Connecting to the overarching question:**

> Among weather, time, location, and rider characteristics, which variables most  strongly drive Citi Bikeusage in Manhattan?

This analysis contributes two insights to that question:

This analysis suggests that infrastructure operates indirectly.  Rather than influencing bike type choice, it determines where stations are placed and where demand concentrates. E-bike usage patterns correlate with station volume, time of day, and rider type, indicating that bike type reflects the same underlying factors that drive overall ridership. This aligns with the group's finding that removing e-bike share from the 
predictive model improved performance.

Taken together, these findings suggest that: 

1. **Time, location, and rider type are primary drivers**: These factors shape both 
   overall demand and observed bike type usage
2. **Infrastructure matters for network design**: It determines where riders can go, 
   but not what they ride once they're there
3. **Operational factors (availability, rebalancing) mediate observed patterns**: 
   What appears to be rider "choice" may actually reflect supply constraints
4. **Simpler models may be more predictive**: Since e-bike usage mirrors the same 
   patterns as overall ridership, treating it as a separate variable adds complexity 
   without explanatory power

Infrastructure builds the network that attracts riders, and time/location/rider type determine when and where that demand occurs. E-bike usage is a byproduct of these factors (shaped by availability and operational decisions) rather than an independent phenomenon requiring separate explanation. For predictive modeling, this means focusing on the fundamental drivers (weather, time, location, rider characteristics) rather than derivative metrics like bike type share.